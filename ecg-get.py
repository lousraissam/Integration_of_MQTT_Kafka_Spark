import json
import time
from kafka import KafkaProducer

producer = KafkaProducer(bootstrap_servers='localhost:9092')

response = {"timestamp": 1630625056.611057, "value": [0.005811760746964489, 0.006734924574214167, 0.0075988793936386054, 0.008410635508251888, 0.009177203221067798, 0.009905592835100716, 0.010602814653364545, 0.011275878978873315, 0.011931785942064038, 0.012575906875480452, 0.01321020927904582, 0.013836233782903261, 0.014455521017196, 0.015069611612067468, 0.015680046197660783, 0.01628836540411904, 0.01689610986158556, 0.017504820200203434, 0.01811603705011596, 0.018731301041466353, 0.01935215280439759, 0.019980132969053276, 0.020616775701186207, 0.0212629223048106, 0.021918113998332052, 0.022581748795946866, 0.02325322471185152, 0.023931939760242354, 0.02461729195531565, 0.0253086793112681, 0.026005499842295953, 0.026706871207112348, 0.02741078964249759, 0.028114971029748574, 0.028817131250162314, 0.02951498618503588, 0.030206258408206326, 0.03088918134588753, 0.031562850448994775, 0.032226444180226126, 0.03287914100227965, 0.03352011937785349, 0.034148557769645704, 0.03476363464035443, 0.03536452845267777, 0.03595041766931378, 0.03652048075296066, 0.037073896166316546, 0.03760984237207946, 0.038127497832947554, 0.03862603788410596, 0.039104459893443175, 0.0395614908079879, 0.03999583493585256, 0.04040619658514965, 0.040791280063991596, 0.041149789680490836, 0.041480429742759756, 0.041781904558910815, 0.04205291843705649, 0.04229217568530918, 0.04249838061178136, 0.042670238000452325, 0.04280679763879382, 0.04290806376911572, 0.04297426067180495, 0.04300569045134532, 0.04300266083818367, 0.04296547956276686, 0.04289445435554182, 0.04278989294695524, 0.04265210306745403, 0.04248139244748506, 0.04227806881749516, 0.0420424399079312, 0.04177481344924003, 0.04147549717186847, 0.04114479880626353, 0.04078302495398513, 0.04039044288233235, 0.03996727124929781, 0.039513725702873585, 0.03903009202620147, 0.03851693654302155, 0.03797489571222361, 0.03740460599269751, 0.036806703843332664, 0.03618182572301903, 0.035530608090646267, 0.0348536874051042, 0.03415170012528248, 0.03342528271007089, 0.03267507525179824, 0.03190182047402426, 0.031106375591807865, 0.030289603834597716, 0.029452368431842322, 0.028595532612990193, 0.027719959607489856, 0.02682651264478976, 0.025916054954338425, 0.024989449765584572, 0.024047560307976324, 0.02309124981096229, 0.022121381503991105, 0.021138818616511134, 0.02014440768178905, 0.01913860613677899, 0.01812147947647092, 0.01709307593053319, 0.016053443728633546, 0.01500263110044035, 0.01394068627562178, 0.012867657483845997, 0.011783592954781147, 0.010688540918095388, 0.009582549603456898, 0.008465667240534044, 0.007337942058994557, 0.006199422288506819, 0.005050234143275013, 0.003892025027713734, 0.002727826000223868, 0.0015607185190361565, 0.00039378404238135916, -0.0007698959715095471, -0.0019272400644062266, -0.0030751667780777254, -0.004210594654293251, -0.00533044223482207, -0.006431628061433393, -0.007511070675896491, -0.008565688619980584, -0.009592285905149142, -0.010587567813091938, -0.011554063231870228, -0.012499177059279673, -0.013430458569726144, -0.01435545703761564, -0.015281721737354021, -0.016216801943347244, -0.01716824693000105, -0.018143605971721693, -0.019150428342914996, -0.020196263317986816, -0.021288660171343156, -0.02243516817738982, -0.023643336610532865, -0.02491908103327895, -0.026245224632821383, -0.02758748147668483, -0.02891116240995746, -0.030181578277727505, -0.03136403992508333, -0.03242385819711318, -0.03332634393890536, -0.034036807995548174, -0.03452056121212991, -0.034742914433738906, -0.03466917850546348, -0.03426466427239209, -0.033494682579612745, -0.03230451049212303, -0.030395160490596315, -0.027304481535826798, -0.022567341462243637, -0.01571860810427572, -0.006293389266764017, 0.00617224736380189, 0.02214199413052112, 0.04207954337649235, 0.0664485874448141, 0.0957128186785795, 0.130335929420898, 0.1707816120148632, 0.21751355880357431, 0.2709972905857351, 0.33171769196795214, 0.40017129693758685, 0.47685479903590516, 0.5622648918041693, 0.656898268783647, 0.7612516235156005, 0.8758216495412715, 1.0011047035205578, 1.137595794587638, 1.2857895949952989, 1.446180776996329, 1.6192640128435165, 1.8055339747896462, 2.0053542586415825, 2.2178757818550876, 2.441593248217479, 2.674994913375712, 2.916569032976698, 3.1648038626674886, 3.4181876580949955, 3.675208674906174, 3.934355168747984, 4.1941153952673815, 4.452977610111324, 4.709430068926768, 4.961961027360673, 5.209058741059996, 5.449151703554397, 5.680183076755907, 5.899860157058005, 6.105888673596786, 6.295974355508387, 6.467822931928956, 6.6191401319946275, 6.747631684841543, 6.851003319605842, 6.926960765423669, 6.973209751431162, 6.987456006764461, 6.967405260559708, 6.910763241953058, 6.815621398134428, 6.68283159780826, 6.514448475771231, 6.312531639639703, 6.079140697030035, 5.81633525555859, 5.526174922841726, 5.210719306495799, 4.872028014137172, 4.512160653382203, 4.133176831847335, 3.7371361571487665, 3.3260982369029373, 2.9021226787262058, 2.467451957688922, 2.025485460105301, 1.5800736778496536, 1.1350686705436321, 0.6943246690523771, 0.2616964470518979, -0.15896122178179342, -0.5637935637726084, -0.948945805244698, -1.3105631725219689, -1.6447908919284109, -1.9477741897880123, -2.215658292424764, -2.4445884261626536, -2.631376083957034, -2.776568087438848, -2.8820121729679546, -2.949557402913847, -2.981052839646014, -2.9783475455339565, -2.9432905829471583, -2.8777310142551085, -2.7835179018272984, -2.6625003080332186, -2.5165272952423603, -2.3474479258242136, -2.157111262148272, -1.9473663665840233, -1.7202695783044144, -1.4789088608277574, -1.226692502472407, -0.9670288911100566, -0.703326414612551, -0.43899346085168384, -0.1774384176992511, 0.07793032697295335, 0.3237043852931353, 0.5564753693894984, 0.7728348913902489, 0.9693746904429463, 1.1426872474437433, 1.2893653117699064, 1.4067647246649255, 1.4956168196943536, 1.5575859574472943, 1.5943365303469152, 1.6075329308163853, 1.5988395512788705, 1.569920784157538, 1.5224410218755555, 1.45806465685609, 1.378456081522309, 1.285279688297399, 1.1801998696044906, 1.0648805925863594, 0.9409841232674799, 0.8101918420857426, 0.6742619892962152, 0.5349717007476387, 0.3940981122887465, 0.25341835976844135, 0.11470957903540373, -0.020251094061466166, -0.14968652367348287, -0.27181957395175343, -0.3848731090475828, -0.4870699931120906, -0.5766330902965658, -0.6517852647521469, -0.7107494271772714, -0.7523427972413379, -0.7774621408558435, -0.7874588055131813, -0.7836841387057178, -0.7674894879258242, -0.740226200665887, -0.703245624418259, -0.6578991066753433, -0.6055379949294782, -0.5475136366730791, -0.4851773793984994, -0.41988057059808637, -0.35297455776426556, -0.28581060164667155, -0.21955265317657022, -0.15478098572903176, -0.09196250463989943, -0.03156411524491673, 0.02594727712007673, 0.08010476711933284, 0.1304414494170172, 0.17649041867735887, 0.21778476956458126, 0.253857596742859, 0.28424199487642815, 0.30847105862947194, 0.32607788266621673, 0.3365959306541634, 0.3398386072857489, 0.3363974361344098, 0.3269980507767696, 0.3123660847894604, 0.29322717174909757, 0.2703069452323205, 0.24433103881574902, 0.2160249229909574, 0.1861134159094042, 0.15532117263746203, 0.12437284824155251, 0.09399309778804818, 0.06490657634337015, 0.037837378096628314, 0.013304891500817859, -0.008679991414818171, -0.028183993970789606, -0.045273839487631154, -0.060016251285875837, -0.07247795268603789, -0.08272566700865423, -0.09082611757424298, -0.09684602770333747, -0.10085212071645934, -0.10291111993413858, -0.1030897486768997, -0.1014547302652704, -0.09807299322878213, -0.09305435762466763, -0.08660404097864496, -0.07894012247641907, -0.07028068130368208, -0.06084379664614071, -0.05084754768948561, -0.04051001361942438, -0.030049273621647672, -0.019683406881862743, -0.009630492585760406, -0.00010860991904762876, 0.008664161932580693, 0.016469743783428803, 0.023090777072805532, 0.02840618676145419, 0.0324869936419441, 0.03542701776371695, 0.037320032623349125, 0.038259406535121866, 0.0383382991875346, 0.03764986854490783, 0.03628727257156211, 0.03434366923181767, 0.03191221648999369, 0.029086072310412252, 0.025958394657391488, 0.022622341495254047, 0.019170793662365907, 0.015671116480860524, 0.012144935399535284, 0.008609955721261492, 0.005087239068608935, 0.0015986861440780657, -0.0018338023498346472, -0.005188325710631341, -0.00844298323581301, -0.01157587422288244, -0.014565097969340973, -0.01738875377269141, -0.020024940930434214, -0.022451758740073144, -0.024647548400302602, -0.026606852681104947, -0.028350348387323678, -0.029901084205029193, -0.031282108820289325, -0.03251647091917448, -0.03362721918775232, -0.0346374023120935, -0.03557006897826547, -0.03644826787233905, -0.03729504768038156, -0.03813345708846389, -0.03898654478265337, -0.03987735944902086, -0.04082870050178568, -0.04185072011513906, -0.042935190882639904, -0.04407243920292483, -0.04525279147462847, -0.046466574096387485, -0.04770411346683655, -0.04895573598461219, -0.050211768048349176, -0.05146253605668406, -0.052698366408251575, -0.053909585501688236, -0.05508651973562887, -0.05621949550870987, -0.05729889610827226, -0.058317360806127684, -0.05927048544694974, -0.060154066102245767, -0.060963898843521394, -0.06169577974228387, -0.06234550487003891, -0.06290887029829371, -0.06338167209855404, -0.06375970634232694, -0.06403876910111847, -0.06421465644643531, -0.06428409769616829, -0.06424755515374635, -0.06410645391628253, -0.06386315779038086, -0.06352114079158747, -0.06308394108566233, -0.06255509683836559, -0.0619381462154575, -0.06123662738269802, -0.06045407850584774, -0.059594037750666226, -0.05866004328291428, -0.05765563326835137, -0.056584345872738334, -0.055449719261834736, -0.054255291601401155, -0.05300457495563643, -0.05170040376845919, -0.05034488892573653, -0.04894010601182798, -0.04748813061109205, -0.04599103830788846, -0.044450904686575296, -0.042869805331512724, -0.041249815827058625, -0.03959301175757324, -0.037901468707414405, -0.03617726226094237, -0.03442246800251493, -0.032639161516492404, -0.030829429116574786, -0.02899558843068738, -0.027140180124430213, -0.025265753936748847, -0.02337485960658713, -0.02147004687289066, -0.019553865474603232, -0.01762886515067064, -0.01569759564003628, -0.013762606681646286, -0.01182643925358876, -0.009891515396584812, -0.007960171435145618, -0.006034741801440431, -0.0041175569361597735, -0.002210874864205508, -0.0003168905646758999, 0.0015622030895202253, 0.0034242132254760516, 0.005266946970282807, 0.007088211451033642, 0.008886113055238358, 0.01065995521208256, 0.012409340611168435, 0.014133871942100354, 0.015833151894480247, 0.01750678315791254, 0.019154368421999225, 0.020775507189329426, 0.02236974976628343, 0.023936607800972017]}
response2 = 'En modifiant le paramètreretention.ms, on demande à Kafka deffacer un segment de données toutes les quatre secondes. \n Un segment est une succession de messages dans une partition.'
while True: 
    record = response
    values = record["value"]
    producer.send("ecg", json.dumps(values).encode())  #topic: velib-stations #key specifices which partition
    print("{} Produced {} records".format(record["timestamp"], len(values)))


    #producer.send("ecg", json.dumps(record).encode('utf-8'))
    #print("{} sent".format(record))
    time.sleep(1)